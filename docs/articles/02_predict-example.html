<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prediction with BCF • bcf2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Prediction with BCF">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bcf2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_simple-example.html">A Simple Example</a>
    </li>
    <li>
      <a href="../articles/02_predict-example.html">Prediction with BCF</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Prediction with BCF</h1>
            
      
      
      <div class="hidden name"><code>02_predict-example.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we show how to use the <code>bcf</code> package to fit a model and use the fitted object to predict estimates for new data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(bcf2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(latex2exp)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</span></code></pre></div>
<p>We will fit the model to simulated data, following exactly the same process as in the main vignette.<br>
For that reason, we do not show the data generation steps here.</p>
<div id="fitting-bcf" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-bcf" class="anchor"></a>Fitting BCF</h2>
<p>We now fit a BCF model to the simulated data. This is the same model as we fit in the main vignette.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>bcf_out &lt;-<span class="st"> </span>bcf2<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bcf2/man/bcf.html">bcf</a></span>(<span class="dt">y               =</span> y,</span>
<span id="cb2-2"><a href="#cb2-2"></a>                     <span class="dt">z               =</span> z,</span>
<span id="cb2-3"><a href="#cb2-3"></a>                     <span class="dt">x_control       =</span> x,</span>
<span id="cb2-4"><a href="#cb2-4"></a>                     <span class="dt">x_moderate      =</span> x,</span>
<span id="cb2-5"><a href="#cb2-5"></a>                     <span class="dt">pihat           =</span> pi,</span>
<span id="cb2-6"><a href="#cb2-6"></a>                     <span class="dt">nburn           =</span> n_burn,</span>
<span id="cb2-7"><a href="#cb2-7"></a>                     <span class="dt">nsim            =</span> n_sim,</span>
<span id="cb2-8"><a href="#cb2-8"></a>                     <span class="dt">w               =</span> weights,</span>
<span id="cb2-9"><a href="#cb2-9"></a>                     <span class="dt">n_chains        =</span> <span class="dv">2</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>                     <span class="dt">update_interval =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="predicting-using-bcf" class="section level2">
<h2 class="hasAnchor">
<a href="#predicting-using-bcf" class="anchor"></a>Predicting using BCF</h2>
<p>We now use our testing Xs for prediction. First, we generate a testing dataset. we purposefully make sure that we have some values outside of the range of our training dataset to allow us to gage out-of-sample error.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">## Testing data</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>n_test =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>x_pred  &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n_test<span class="op">*</span>p), <span class="dt">nrow=</span>n_test)</span>
<span id="cb3-5"><a href="#cb3-5"></a>special_x3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">3.1</span>, <span class="fl">-2.9</span>, <span class="fl">2.76</span>, <span class="fl">2.8</span>, <span class="fl">2.85</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>x_pred[ (n_test <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(special_x3) <span class="op">+</span><span class="st"> </span><span class="dv">1</span> )<span class="op">:</span>n_test,<span class="dv">3</span>] &lt;-<span class="st"> </span>special_x3 <span class="co"># including some X3s outside of range</span></span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a>q_pred  &lt;-<span class="st"> </span><span class="dv">-1</span><span class="op">*</span>(x_pred[,<span class="dv">1</span>]<span class="op">&gt;</span>(x_pred[,<span class="dv">2</span>])) <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">*</span>(x_pred[,<span class="dv">1</span>]<span class="op">&lt;</span>(x_pred[,<span class="dv">2</span>])) <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>pi_pred &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(q_pred)</span>
<span id="cb3-10"><a href="#cb3-10"></a>z_pred  &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(n_test,<span class="dv">1</span>, pi_pred)</span></code></pre></div>
<p>We now use this data to generate predictions based on our model.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>pred_out =<span class="st"> </span>bcf2<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bcf2/man/predict.html">predict</a></span>(<span class="dt">bcf_out=</span>bcf_out,</span>
<span id="cb4-2"><a href="#cb4-2"></a>                         <span class="dt">x_predict_control=</span>x_pred,</span>
<span id="cb4-3"><a href="#cb4-3"></a>                         <span class="dt">x_predict_moderate=</span>x_pred,</span>
<span id="cb4-4"><a href="#cb4-4"></a>                         <span class="dt">pi_pred=</span>pi_pred,</span>
<span id="cb4-5"><a href="#cb4-5"></a>                         <span class="dt">z_pred=</span>z_pred,</span>
<span id="cb4-6"><a href="#cb4-6"></a>                         <span class="dt">save_tree_directory =</span> <span class="st">'..'</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt; Initializing BCF Prediction</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; Starting Prediction</span></span></code></pre></div>
</div>
<div id="comparison" class="section level2">
<h2 class="hasAnchor">
<a href="#comparison" class="anchor"></a>Comparison</h2>
<p>Let’s compare the results of our training and testing data. We will show the estimated treatment effects for training and test observations as a function of <span class="math inline">\(x_3\)</span>, which is an effect modifier.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>lower &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(bcf_out<span class="op">$</span>tau, <span class="dv">2</span>, quantile, <span class="fl">0.025</span>), <span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(pred_out<span class="op">$</span>tau, <span class="dv">2</span>, quantile, <span class="fl">0.025</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a>upper &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(bcf_out<span class="op">$</span>tau, <span class="dv">2</span>, quantile, <span class="fl">0.975</span>), <span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(pred_out<span class="op">$</span>tau, <span class="dv">2</span>, quantile, <span class="fl">0.975</span>))</span>
<span id="cb5-3"><a href="#cb5-3"></a>group &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"training"</span>, n), <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"testing"</span>, n_test)))</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">ggplot</span>(<span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(x[,<span class="dv">3</span>], x_pred[,<span class="dv">3</span>]), </span>
<span id="cb5-6"><a href="#cb5-6"></a>                 <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span>(bcf_out<span class="op">$</span>tau), <span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span>(pred_out<span class="op">$</span>tau)),</span>
<span id="cb5-7"><a href="#cb5-7"></a>                 <span class="dt">alpha =</span> group,</span>
<span id="cb5-8"><a href="#cb5-8"></a>                 <span class="dt">color =</span> group)) <span class="op">+</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper)) <span class="op">+</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="st">  </span><span class="kw">scale_alpha_discrete</span>(<span class="dt">range =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.0</span>, <span class="fl">0.3</span>)) <span class="op">+</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">TeX</span>(<span class="st">"$x_3$"</span>)) <span class="op">+</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">TeX</span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">hat{</span><span class="ch">\\</span><span class="st">tau}$"</span>)) <span class="op">+</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="st">  </span><span class="kw">coord_flip</span>()</span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt; Warning: Using alpha for a discrete variable is not advised.</span></span></code></pre></div>
<p><img src="02_predict-example_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The estimates for testing observations have treatmentent effects well within the range of the treatment effects for training observations, even though the test data set contains more extreme values of <span class="math inline">\(x_3\)</span>. It is reassuring that these observations’ treatment effects still fall within the expected range, suggesting that this model is not overly vulnerable to out-of-sample prediction error.</p>
</div>
<div id="marginal-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#marginal-effects" class="anchor"></a>Marginal effects</h2>
<p>We can use predict() to compute mean marginal effects, in other words the mean difference in predicted estimates assuming all observations have the same characteristics but one. We provide an example using the extreme cut-offs identified in the CART tree of the main vignette (<span class="math inline">\(x_3 = -1.8\)</span> and <span class="math inline">\(x_3 = 0.48\)</span>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>x_low &lt;-<span class="st"> </span>x; x_high &lt;-<span class="st"> </span>x</span>
<span id="cb6-2"><a href="#cb6-2"></a>x_low[,<span class="dv">3</span>]  &lt;-<span class="st"> </span><span class="fl">-1.8</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>x_high[,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="fl">0.48</span></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>pred_low =<span class="st"> </span>bcf2<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bcf2/man/predict.html">predict</a></span>(<span class="dt">bcf_out=</span>bcf_out,</span>
<span id="cb6-6"><a href="#cb6-6"></a>                         <span class="dt">x_predict_control=</span>x_low,</span>
<span id="cb6-7"><a href="#cb6-7"></a>                         <span class="dt">x_predict_moderate=</span>x_low,</span>
<span id="cb6-8"><a href="#cb6-8"></a>                         <span class="dt">pi_pred=</span>pi,</span>
<span id="cb6-9"><a href="#cb6-9"></a>                         <span class="dt">z_pred=</span>z,</span>
<span id="cb6-10"><a href="#cb6-10"></a>                         <span class="dt">save_tree_directory =</span> <span class="st">'..'</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; Initializing BCF Prediction</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; Starting Prediction</span></span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a>pred_high =<span class="st"> </span>bcf2<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bcf2/man/predict.html">predict</a></span>(<span class="dt">bcf_out=</span>bcf_out,</span>
<span id="cb6-15"><a href="#cb6-15"></a>                          <span class="dt">x_predict_control=</span>x_high,</span>
<span id="cb6-16"><a href="#cb6-16"></a>                          <span class="dt">x_predict_moderate=</span>x_high,</span>
<span id="cb6-17"><a href="#cb6-17"></a>                          <span class="dt">pi_pred=</span>pi,</span>
<span id="cb6-18"><a href="#cb6-18"></a>                          <span class="dt">z_pred=</span>z,</span>
<span id="cb6-19"><a href="#cb6-19"></a>                          <span class="dt">save_tree_directory =</span> <span class="st">'..'</span>)</span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; Initializing BCF Prediction</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt; Starting Prediction</span></span></code></pre></div>
<p>Now that we have our predictions, we look at the distributions of average treatment effects for each group.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Computing weighted means to get distribution of posterior average estimates</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>lowDist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(pred_low<span class="op">$</span>tau, <span class="dv">1</span>, weighted.mean, weights)</span>
<span id="cb7-3"><a href="#cb7-3"></a>highDist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(pred_high<span class="op">$</span>tau, <span class="dv">1</span>, weighted.mean, weights)</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a>distDF &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">taus  =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(lowDist, highDist),</span>
<span id="cb7-6"><a href="#cb7-6"></a>                     <span class="dt">Group =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"X3 = -1.8"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(lowDist)), <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"X3 = 0.48"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(highDist)))))</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="kw">ggplot</span>(distDF, <span class="kw">aes</span>(taus, <span class="dt">group =</span> Group, <span class="dt">color =</span> Group, <span class="dt">fill =</span> Group)) <span class="op">+</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">+</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">TeX</span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">tau$"</span>))</span></code></pre></div>
<p><img src="02_predict-example_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>We see that the marginal mean treatment effects for the two groups barely overlap. We can confirm this by comparing the 95% credible intervals for each distribution.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#fitting-bcf">Fitting BCF</a></li>
      <li><a href="#predicting-using-bcf">Predicting using BCF</a></li>
      <li><a href="#comparison">Comparison</a></li>
      <li><a href="#marginal-effects">Marginal effects</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jared S. Murray, P. Richard Hahn, Carlos Carvalho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
